#include "SampleSearch.h"#include "Globals.h"#include "autoReplace.h"Boolean addFileToList(FSSpec mySpec);OSErr GetFileGray(FSSpec *myFSSpec);Boolean translateParentToChildFolder(FSSpec *mySpec);extern short totfindcounter;void watchcursor(Boolean seting);OSErr replaceFilesFromFolder (void){	FSSpec theNewFilesFolder,tempspec,movespec;	OSErr iErr;	short z;	Cell theCell;	short theindex;	StandardFileReply myReply;	short refNum;	IOParam pb;	Str255 theText;	long inOutCount = 0;	short	len, rc;	Str255 theOtherText;	long rejectDirID;	FInfo fndrInfo;			iErr = GetFileGray(&theNewFilesFolder);	if (iErr)	{		return -1;	}	translateParentToChildFolder(&theNewFilesFolder);		iErr = DirCreate(theNewFilesFolder.vRefNum,theNewFilesFolder.parID,"\pOriginal Files",&rejectDirID);		watchcursor(true);	SetPt( &theCell, 0,0 );		/* start at top of list  */	while ( LGetSelect( TRUE, &theCell, myList) ) 	{				theindex = (theCell.v * DisplayedColumns) + (theCell.h * (DisplayedColumns != 1));				if ((*therealResults)[theindex].vRefNum == theNewFilesFolder.vRefNum)		{			iErr = FSMakeFSSpec(theNewFilesFolder.vRefNum,theNewFilesFolder.parID,(*therealResults)[theindex].name,&tempspec);			if (!iErr)			{				iErr = FSpGetFInfo(&tempspec,&fndrInfo);				iErr = CatMove((*therealResults)[theindex].vRefNum,(*therealResults)[theindex].parID,(*therealResults)[theindex].name,rejectDirID,0);				iErr = FSMakeFSSpec((*therealResults)[theindex].vRefNum,rejectDirID,(*therealResults)[theindex].name,&movespec);				addFileToList(movespec);				/* move the old file into the reject bin */				iErr = CatMove(tempspec.vRefNum,tempspec.parID,tempspec.name,(*therealResults)[theindex].parID,0);				(*theFInfo)[theindex] = fndrInfo;				/* move the new file into its place */				/* log the sucess */			}			else			{				/* log the problem */						}		}		else		{			/* log the problem */		}				LNextCell( TRUE, TRUE, &theCell, myList ); 	/* advance to next */	}	watchcursor(false);		}