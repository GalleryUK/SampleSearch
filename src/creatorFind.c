#include "SampleSearch.h"#include "Globals.h"extern Boolean creatorSearch;extern OSType creatorSearchType;OSErr chooseTargetAppOther(OSType * Sig, StringPtr AppName, short * splitFiles);OSType creatorFindDialog(void);OSType creatorFindDialog(void){	short itemHit;				/** for dialog enquiry **/	DialogPtr	myDlg;			/** for dialog enquiry **/	Handle	iHndl;				/** for dialog enquiry **/	Rect	iRect;				/** for dialog enquiry **/	short	iType;				/** for dialog enquiry **/	Str255 textStr;	OSType theRetType;	StandardFileReply	reply;	FInfo fndrInfo;	OSErr	iErr;	GrafPtr savePort;		GetPort (&savePort);		myDlg = GetNewDialog(11200,0L,(WindowPtr)-1);	GetDItem(myDlg,3,&iType,&iHndl,&iRect);	SetDItem(myDlg,3,iType,(Handle)NewUserItemProc(MyItemProc),&iRect);	SetPort (myDlg);		color.red = 56797;	color.green = 56797;	color.blue = 56797;	RGBBackColor(&color);		ShowWindow(myDlg);		do	{		ModalDialog(xAlertFilter,&itemHit);		if (itemHit == 5)		{			StandardGetFile(0,-1,0,&reply);			if (reply.sfGood)			{				iErr = FSpGetFInfo(&(reply.sfFile),&fndrInfo);				if (iErr != 0)					genError ("\pCan't get file info");				BlockMove(&(fndrInfo.fdCreator), textStr + 1, 4L);				*textStr = 4;				GetDItem(myDlg,4,&iType,&iHndl,&iRect);				SetIText(iHndl,textStr);			}		}	}while (itemHit == 5);		if (itemHit == 2)	{		DisposDialog(myDlg);		SetPort (savePort);		return 0;	}	if (itemHit == 1)	{		GetDItem(myDlg,4,&iType,&iHndl,&iRect);		GetIText(iHndl,textStr);		BlockMove (textStr +1, &theRetType,4L);		if (!(*textStr))		{			theRetType = 0;		}		DisposDialog(myDlg);		SetPort (savePort);		return theRetType;	}			DisposDialog(myDlg);	SetPort (savePort);}OSErr chooseTargetAppOther(OSType * Sig, StringPtr AppName, short * splitFiles){	short itemHit;				/** for dialog enquiry **/	DialogPtr	myDlg;			/** for dialog enquiry **/	Handle	iHndl;				/** for dialog enquiry **/	Rect	iRect;				/** for dialog enquiry **/	short	iType;				/** for dialog enquiry **/	Str255 textStr;	OSType theRetType;	StandardFileReply	reply;	FInfo fndrInfo;	OSErr	iErr;	GrafPtr savePort;	SFTypeList typeList = {'APPL',0,0,0};	GetPort (&savePort);		myDlg = GetNewDialog(11201,0L,(WindowPtr)-1);	GetDItem(myDlg,3,&iType,&iHndl,&iRect);	SetDItem(myDlg,3,iType,(Handle)NewUserItemProc(MyItemProc),&iRect);	SetPort (myDlg);		color.red = 56797;	color.green = 56797;	color.blue = 56797;	RGBBackColor(&color);		BlockMove(Sig, textStr + 1, 4L);	*textStr = 4;	GetDItem(myDlg,4,&iType,&iHndl,&iRect);	SetIText(iHndl,textStr);	GetDItem(myDlg,7,&iType,&iHndl,&iRect);	SetIText(iHndl,AppName);	GetDItem(myDlg,9,&iType,&iHndl,&iRect);	SetCtlValue((ControlHandle)iHndl,* splitFiles);	ShowWindow(myDlg);	itemHit = 0;	do	{		ModalDialog(xAlertFilter,&itemHit);		if (itemHit == 5)		{			StandardGetFile(0,1,typeList,&reply);			if (reply.sfGood)			{				iErr = FSpGetFInfo(&(reply.sfFile),&fndrInfo);				if (iErr != 0)					genError ("\pCan't get file info");				BlockMove(&(fndrInfo.fdCreator), textStr + 1, 4L);				*textStr = 4;				GetDItem(myDlg,4,&iType,&iHndl,&iRect);				SetIText(iHndl,textStr);								GetDItem(myDlg,7,&iType,&iHndl,&iRect);				SetIText(iHndl,reply.sfFile.name);							}		}		if (itemHit == 9)		{			GetDItem(myDlg,9,&iType,&iHndl,&iRect);			SetCtlValue((ControlHandle)iHndl,!GetCtlValue((ControlHandle)iHndl));		}	}while (itemHit == 5 || itemHit == 9 );		if (itemHit == 2)	{		DisposDialog(myDlg);		SetPort (savePort);		return 0;	}	if (itemHit == 1)	{		GetDItem(myDlg,4,&iType,&iHndl,&iRect);		GetIText(iHndl,textStr);		BlockMove (textStr +1, &theRetType,4L);		if (!(*textStr))		{			theRetType = 0;		}				*Sig = theRetType;		GetDItem(myDlg,7,&iType,&iHndl,&iRect);		GetIText(iHndl,AppName);		GetDItem(myDlg,9,&iType,&iHndl,&iRect);		*splitFiles = GetCtlValue((ControlHandle)iHndl);		DisposDialog(myDlg);		SetPort (savePort);		return theRetType;	}			DisposDialog(myDlg);	SetPort (savePort);}