typedef struct driveDescription {	Str31 driveName;	short driveVRef;	Boolean currentlyMounted;	short realVRefNum;} driveDescription;short volumeMapper[499];extern short fvolumes[1000];extern short fvolumearrayptr;extern Str31 fvolName[499];extern short volumearrayptr;					/** pointer to end of volumes[]  **/short getDriveRefNum(Str31 theDriveName);extern short totfindcounter;extern FSSpec ** therealResults;OSErr translateVRefNum(short * theVRef);short resolveVRefNum(short theVRef);driveDescription theTabSpecDrives[499];short numDrives;OSErr copyVolsListToFVolsList(void);void resolveListEntries(FSSpec faveFile);void resolveListEntries(FSSpec faveFile){	Handle theORef, theOVol;	short rfRefNum;	short iRefNum;	short oREFCnt, oVOLCnt;	short z,q;	short realRef;		numDrives = 0;		iRefNum = CurResFile();				rfRefNum = FSpOpenResFile(&faveFile,fsRdPerm);	if (rfRefNum == -1)	{		return;	}	UseResFile (rfRefNum);		oREFCnt = Count1Resources('oREF');	oVOLCnt = Count1Resources('oVOL');		if (oREFCnt != oVOLCnt)	{		CloseResFile(rfRefNum);		UseResFile (iRefNum);		return;	}		numDrives = oREFCnt;		for (z=0;z<499;z++)	{		volumeMapper[z] = 0;	}	copyVolsListToFVolsList();		for (z=1;z<= oREFCnt;z++)	{		theORef = GetIndResource('oREF',z);		theOVol = GetIndResource('oVOL',z);		theTabSpecDrives[z].driveVRef = (short)(SignedByte)(*(Byte*)(*theORef));		BlockMove(*theOVol, theTabSpecDrives[z].driveName,(**theOVol) + 1);		realRef = getDriveRefNum(theTabSpecDrives[z].driveName); /* check if it is mounted */		if (realRef == -99)		{			volumeMapper[-(theTabSpecDrives[z].driveVRef)] = theTabSpecDrives[z].driveVRef - volumearrayptr;			for (q=1;q<fvolumearrayptr;q++)			{				if(EqualString(theTabSpecDrives[z].driveName,fvolName[q],true,true)) 				{						volumeMapper[-(theTabSpecDrives[z].driveVRef)] = fvolumes[q];				}					}			theTabSpecDrives[z].currentlyMounted = false;		}		else		{			theTabSpecDrives[z].currentlyMounted = true;			theTabSpecDrives[z].realVRefNum = realRef;			volumeMapper[-(theTabSpecDrives[z].driveVRef)] = realRef;		}	}	CloseResFile(rfRefNum);	UseResFile (iRefNum);		for (z=0;z<totfindcounter;z++)	{		(*therealResults)[z].vRefNum = volumeMapper[-((*therealResults)[z].vRefNum)];			}	return;}short getDriveRefNum(Str31 theDriveName){	VolumeParam pb;	OSErr iErr = 0;	short z = 1;	Str255 theCurrentIndex;	while (iErr == 0)	{		pb.ioCompletion = 0;		pb.ioVolIndex = z;		pb.ioVRefNum = 0;		pb.ioNamePtr = theCurrentIndex;		iErr = PBGetVInfo((union ParamBlockRec *)&pb,false);		if (iErr)		{			return -99;		}		else		{				if(EqualString(theCurrentIndex,theDriveName,true,true)) 			{				return pb.ioVRefNum;			}		}		z++;	}	return -99;}