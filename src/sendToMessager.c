#include <Gestalt.h>#include <AppleEvents.h>#define kReverServerClass		'Tsrv'#define kSetTextID				'SETT'#define kMaxTextSize 255void SendTextToMessageBoard(Str255 theText ){	AEAddressDesc	targetAddrDesc = {typeNull, nil};	long			targetSignature = 'dCOD';	AppleEvent		event = {typeNull, nil};	AppleEvent		reply = {typeNull, nil};	OSErr			err;	DescType		actualtype;	Size			actualSize;	AEEventID idToSend = 'SETT';	 	err = AECreateDesc( typeApplSignature, (Ptr)(&targetSignature),				sizeof( targetSignature ), &targetAddrDesc );		if ( err != noErr )		{			return;		}			err = AECreateAppleEvent( kReverServerClass, idToSend,							&targetAddrDesc, kAutoGenerateReturnID,							kAnyTransactionID, &event );		if ( err != noErr )		{			return;		}		if(*theText) // if we have a string longer than 0	{		err = AEPutParamPtr( &event, keyDirectObject, typeChar,					(Ptr)(&(theText[ 1 ])), theText[ 0 ] );				if ( err != noErr )		{			return;		}	}		err = AESend( &event, &reply, kAEWaitReply + kAECanInteract + kAECanSwitchLayer,				kAEHighPriority, kAEDefaultTimeout, 0, 0 );		if ( err == connectionInvalid )	{	{			return;		}				AEDisposeDesc( &targetAddrDesc );		AEDisposeDesc( &event );		AEDisposeDesc( &reply );		return;	}		if ( err != noErr )		{			return;		}		err = AEGetParamPtr( &reply, keyDirectObject, typeChar,			&actualtype, (Ptr)(&(theText[ 1 ])), kMaxTextSize, &actualSize );				theText[0] = actualSize;		if (( err != noErr ) && (err != errAEDescNotFound))		{			return;		}			AEDisposeDesc (&targetAddrDesc);	AEDisposeDesc (&event);	AEDisposeDesc (&reply);		}